parameters:
  - name: projectName
    type: string
  - name: dbProjects
    type: object
    default: ['Nexus.WeightTracker.Api']

stages:
  - stage: deploy_${{ parameters.projectName }}
    jobs:
      - template: ../jobs/docker_deploy_job.yml
        parameters:
          projectName: ${{ parameters.projectName }}

    - ${{ each dbProject in parameters.dbProjects }}:
      - template: ../jobs/db_deploy_job.yml
        parameters:
          projectName: ${{ replace(dbProject,'.','_') }}
          
          
  