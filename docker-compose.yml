version: '3.4'

name: nexus

services:    
  nexus.todo.api:
    image: ${DOCKER_REGISTRY:-tjackadams}/nexus.todo.api:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: Nexus.Hub/Nexus.Todo.Api/Dockerfile
    pull_policy: always

  nexus.weighttracker.api:
    image: ${DOCKER_REGISTRY:-tjackadams}/nexus.weighttracker.api:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: Nexus.Hub/Nexus.WeightTracker.Api/Dockerfile
    pull_policy: always


  nexus.gateway:
    image: ${DOCKER_REGISTRY:-tjackadams}/nexus.gateway:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: Nexus.Hub/Nexus.Gateway/Dockerfile
    pull_policy: always
    depends_on:
      - nexus.todo.api

  nexus.portal:
    image: ${DOCKER_REGISTRY:-tjackadams}/nexus.portal:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: Nexus.Hub/Nexus.Portal/Dockerfile
    pull_policy: always
    depends_on:
      - nexus.gateway


